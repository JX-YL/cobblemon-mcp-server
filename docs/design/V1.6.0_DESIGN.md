# v1.6.0 æ‹›å¼ç³»ç»Ÿå®Œå–„ - è®¾è®¡æ–‡æ¡£

## ğŸ“‹ ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**ï¼šå®Œæ•´æ”¯æŒå®˜æ–¹ Cobblemon æ‹›å¼ç³»ç»Ÿçš„æ‰€æœ‰åˆ†ç±»

**è¦†ç›–ç‡æå‡**ï¼š62% â†’ 75% (+13%)

---

## ğŸ¯ åŠŸèƒ½éœ€æ±‚åˆ†æ

### 1. æ‹›å¼åˆ†ç±»ï¼ˆåŸºäºå®˜æ–¹æ ¼å¼ï¼‰

ä»å‚è€ƒåŒ…åˆ†æï¼ˆ`charmander.json`ï¼‰ï¼Œå®˜æ–¹æ”¯æŒ **6 ç§æ‹›å¼åˆ†ç±»**ï¼š

| åˆ†ç±» | å‰ç¼€æ ¼å¼ | ç¤ºä¾‹ | æ•°é‡ï¼ˆå–·ç«é¾™ï¼‰ |
|------|---------|------|---------------|
| **ç­‰çº§æ‹›å¼** | `"ç­‰çº§:æ‹›å¼"` | `"1:scratch"`, `"4:ember"` | 13ä¸ª |
| **è›‹æ‹›å¼** | `"egg:æ‹›å¼"` | `"egg:bellydrum"` | 10ä¸ª |
| **TMæ‹›å¼** | `"tm:æ‹›å¼"` | `"tm:flamethrower"` | 61ä¸ª |
| **æ•™å­¦æ‹›å¼** | `"tutor:æ‹›å¼"` | `"tutor:blastburn"` | 22ä¸ª |
| **é—ç•™æ‹›å¼** | `"legacy:æ‹›å¼"` | `"legacy:attract"` | 30ä¸ª |
| **ç‰¹æ®Šæ‹›å¼** | `"special:æ‹›å¼"` | `"special:celebrate"` | 5ä¸ª |

**å®˜æ–¹JSONæ ¼å¼**ï¼šæ‰€æœ‰æ‹›å¼å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­
```json
"moves": [
    "1:scratch",
    "1:growl",
    "4:ember",
    "egg:bellydrum",
    "tm:flamethrower",
    "tutor:blastburn",
    "legacy:attract",
    "special:celebrate"
]
```

---

### 2. å½“å‰å®ç°ï¼ˆv1.5.1ï¼‰çš„é—®é¢˜

```python
# å½“å‰æ–¹å¼ï¼ˆè¿‡äºç®€å•ï¼‰
create_pokemon_with_stats(
    moves=["1:tackle", "5:ember"]  # âŒ ä»…æ”¯æŒç®€å•åˆ—è¡¨
)
```

**é—®é¢˜ï¼š**
- âŒ æ— æ³•åŒºåˆ†æ‹›å¼ç±»å‹
- âŒ ç”¨æˆ·éœ€æ‰‹åŠ¨å†™å‰ç¼€
- âŒ æ— æ³•éªŒè¯æ‹›å¼æ˜¯å¦å­˜åœ¨
- âŒ æ— æ³•æŒ‰ç­‰çº§è‡ªåŠ¨æ’åº

---

### 3. v1.6.0 æ–°APIè®¾è®¡

#### æ–¹æ¡ˆAï¼šå­—å…¸åˆ†ç±»ï¼ˆæ¨èï¼‰âœ…

```python
create_pokemon_with_stats(
    name="Charmander",
    
    # ç­‰çº§æ‹›å¼ï¼ˆå­—å…¸æ ¼å¼ï¼Œè‡ªåŠ¨æ’åºï¼‰
    level_moves={
        1: ["scratch", "growl"],
        4: ["ember"],
        8: ["smokescreen"],
        12: ["dragonbreath"]
    },
    
    # è›‹æ‹›å¼ï¼ˆåˆ—è¡¨æ ¼å¼ï¼‰
    egg_moves=["bellydrum", "dragontail", "metalclaw"],
    
    # TMæ‹›å¼
    tm_moves=["flamethrower", "fireblast", "swordsdance"],
    
    # æ•™å­¦æ‹›å¼
    tutor_moves=["blastburn", "heatwave", "firepunch"],
    
    # é—ç•™æ‹›å¼
    legacy_moves=["attract", "return", "toxic"],
    
    # ç‰¹æ®Šæ‹›å¼
    special_moves=["celebrate", "howl"]
)
```

**ä¼˜åŠ¿ï¼š**
- âœ… æ¸…æ™°çš„åˆ†ç±»
- âœ… è‡ªåŠ¨æ ¼å¼åŒ–ï¼ˆå†…éƒ¨è½¬æ¢ä¸º `"1:scratch"` æ ¼å¼ï¼‰
- âœ… è‡ªåŠ¨æŒ‰ç­‰çº§æ’åº
- âœ… å¯å•ç‹¬éªŒè¯æ¯ä¸ªæ‹›å¼

#### æ–¹æ¡ˆBï¼šå…¼å®¹æ¨¡å¼ï¼ˆä¿ç•™æ—§APIï¼‰

```python
create_pokemon_with_stats(
    # æ—§æ–¹å¼ï¼ˆv1.5.1ï¼Œä»æ”¯æŒï¼‰
    moves=["1:tackle", "egg:bellydrum"],
    
    # æ–°æ–¹å¼ï¼ˆv1.6.0ï¼Œæ¨èï¼‰
    level_moves={1: ["scratch"]},
    egg_moves=["bellydrum"]
)
```

**åˆå¹¶é€»è¾‘ï¼š**
- å¦‚æœåŒæ—¶æä¾› `moves` å’Œ `level_moves`ï¼Œåˆ™åˆå¹¶
- `moves` ä¸­çš„å†…å®¹ä¼šè¢«è§£æå¹¶åˆ†ç±»

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ‹›å¼éªŒè¯å™¨ï¼ˆMoveValidatorï¼‰

**è·¯å¾„**ï¼š`tools/validators/move_validator.py`

**åŠŸèƒ½ï¼š**
```python
class MoveValidator:
    """éªŒè¯æ‹›å¼æ˜¯å¦å­˜åœ¨"""
    
    # å®˜æ–¹æ‹›å¼åˆ—è¡¨ï¼ˆä»å‚è€ƒæ•°æ®å¯¼å…¥ï¼‰
    OFFICIAL_MOVES = [
        "tackle", "scratch", "ember", "flamethrower",
        "thunderbolt", "hydropump", ...
    ]
    
    @staticmethod
    def validate_move(move_name: str) -> tuple[bool, str]:
        """éªŒè¯å•ä¸ªæ‹›å¼"""
        move = move_name.lower().strip()
        if move in MoveValidator.OFFICIAL_MOVES:
            return True, ""
        else:
            suggestions = MoveValidator.get_suggestions(move)
            return False, f"æ‹›å¼ '{move_name}' ä¸å­˜åœ¨ã€‚å»ºè®®ï¼š{suggestions}"
    
    @staticmethod
    def get_suggestions(partial: str) -> list:
        """æ¨¡ç³ŠåŒ¹é…å»ºè®®"""
        # ä½¿ç”¨ç¼–è¾‘è·ç¦»ç®—æ³•
        ...
    
    @staticmethod
    def validate_level_moves(level_moves: dict) -> tuple[bool, list]:
        """éªŒè¯ç­‰çº§æ‹›å¼"""
        errors = []
        for level, moves in level_moves.items():
            if not isinstance(level, int) or level < 1:
                errors.append(f"ç­‰çº§ {level} æ— æ•ˆï¼ˆå¿…é¡» >= 1ï¼‰")
            for move in moves:
                is_valid, msg = MoveValidator.validate_move(move)
                if not is_valid:
                    errors.append(f"ç­‰çº§ {level}: {msg}")
        return len(errors) == 0, errors
```

---

### 2. æ‹›å¼æ ¼å¼åŒ–å™¨ï¼ˆMoveFormatterï¼‰

**è·¯å¾„**ï¼š`tools/validators/move_validator.py`ï¼ˆåŒæ–‡ä»¶ï¼‰

**åŠŸèƒ½ï¼š**
```python
class MoveFormatter:
    """æ ¼å¼åŒ–æ‹›å¼ä¸ºå®˜æ–¹æ ¼å¼"""
    
    @staticmethod
    def format_level_moves(level_moves: dict) -> list[str]:
        """
        è¾“å…¥ï¼š{1: ["scratch", "growl"], 4: ["ember"]}
        è¾“å‡ºï¼š["1:scratch", "1:growl", "4:ember"]
        """
        result = []
        for level in sorted(level_moves.keys()):  # è‡ªåŠ¨æ’åº
            for move in level_moves[level]:
                result.append(f"{level}:{move.lower()}")
        return result
    
    @staticmethod
    def format_egg_moves(egg_moves: list) -> list[str]:
        """
        è¾“å…¥ï¼š["bellydrum", "dragontail"]
        è¾“å‡ºï¼š["egg:bellydrum", "egg:dragontail"]
        """
        return [f"egg:{move.lower()}" for move in egg_moves]
    
    @staticmethod
    def format_tm_moves(tm_moves: list) -> list[str]:
        """æ ¼å¼åŒ–TMæ‹›å¼"""
        return [f"tm:{move.lower()}" for move in tm_moves]
    
    # åŒç†ï¼štutor_moves, legacy_moves, special_moves
```

---

### 3. server.py æ›´æ–°

**æ›´æ–°å‡½æ•°ç­¾åï¼š**
```python
async def create_pokemon_with_stats(
    # ... ç°æœ‰å‚æ•° ...
    
    # v1.6.0: æ‹›å¼ç³»ç»Ÿ
    level_moves: dict = None,         # {1: ["tackle"], 5: ["ember"]}
    egg_moves: list = None,           # ["bellydrum", "dragontail"]
    tm_moves: list = None,            # ["flamethrower", "fireblast"]
    tutor_moves: list = None,         # ["blastburn", "heatwave"]
    legacy_moves: list = None,        # ["attract", "return"]
    special_moves: list = None,       # ["celebrate"]
    
    # å…¼å®¹æ—§API
    moves: list = None                # ["1:tackle", "egg:bellydrum"]
) -> dict:
```

**å¤„ç†é€»è¾‘ï¼š**
```python
from tools.validators.move_validator import MoveValidator, MoveFormatter

# 1. éªŒè¯æ‰€æœ‰æ‹›å¼
all_moves = []

if level_moves:
    is_valid, errors = MoveValidator.validate_level_moves(level_moves)
    if not is_valid:
        raise ValueError(f"ç­‰çº§æ‹›å¼éªŒè¯å¤±è´¥ï¼š{errors}")
    all_moves.extend(MoveFormatter.format_level_moves(level_moves))

if egg_moves:
    for move in egg_moves:
        is_valid, msg = MoveValidator.validate_move(move)
        if not is_valid:
            raise ValueError(f"è›‹æ‹›å¼éªŒè¯å¤±è´¥ï¼š{msg}")
    all_moves.extend(MoveFormatter.format_egg_moves(egg_moves))

# åŒç†å¤„ç† tm_moves, tutor_moves, legacy_moves, special_moves

# 2. åˆå¹¶æ—§APIï¼ˆå…¼å®¹æ¨¡å¼ï¼‰
if moves:
    all_moves.extend(moves)

# 3. æ·»åŠ åˆ°speciesæ•°æ®
species["moves"] = all_moves
```

---

### 4. æ‹›å¼å‚è€ƒæ•°æ®å¯¼å…¥

**è·¯å¾„**ï¼š`data/official_moves.json`

**æ ¼å¼ï¼š**
```json
{
  "moves": [
    "tackle", "scratch", "ember", "flamethrower",
    "thunderbolt", "hydropump", "surf", "earthquake",
    ...
  ],
  "total": 919,
  "source": "Cobblemon 1.5.0 Official",
  "last_updated": "2025-10-28"
}
```

**ç”Ÿæˆæ–¹å¼ï¼š**
- ä»å®˜æ–¹å‚è€ƒåŒ…ä¸­æå–æ‰€æœ‰æ‹›å¼å
- å»é‡ã€æ’åº
- ä¿å­˜ä¸ºJSON

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥ï¼ˆæ¸è¿›å¼ï¼‰

### Step 1: åŸºç¡€ç­‰çº§æ‹›å¼
```python
# æµ‹è¯•å®å¯æ¢¦1ï¼šSimplemoveï¼ˆç®€å•ç­‰çº§æ‹›å¼ï¼‰
create_pokemon_with_stats(
    name="Simplemove",
    dex=10001,
    primary_type="normal",
    level_moves={
        1: ["tackle"],
        5: ["quickattack"],
        10: ["bodyslam"]
    }
)
```

### Step 2: å¤šåˆ†ç±»æ‹›å¼
```python
# æµ‹è¯•å®å¯æ¢¦2ï¼šMultimoveï¼ˆå¤šåˆ†ç±»æ‹›å¼ï¼‰
create_pokemon_with_stats(
    name="Multimove",
    dex=10002,
    primary_type="fire",
    level_moves={1: ["scratch"], 10: ["ember"]},
    egg_moves=["bellydrum"],
    tm_moves=["flamethrower", "fireblast"]
)
```

### Step 3: å®Œæ•´æ‹›å¼åˆ—è¡¨ï¼ˆå‚è€ƒCharmanderï¼‰
```python
# æµ‹è¯•å®å¯æ¢¦3ï¼šFullmoveï¼ˆå®Œæ•´æ‹›å¼ï¼Œ141ä¸ªï¼‰
create_pokemon_with_stats(
    name="Fullmove",
    dex=10003,
    primary_type="fire",
    level_moves={1: ["scratch", "growl"], 4: ["ember"], ...},
    egg_moves=["bellydrum", "dragontail", ...],
    tm_moves=["flamethrower", "fireblast", ...],
    tutor_moves=["blastburn", "heatwave", ...],
    legacy_moves=["attract", "return", ...],
    special_moves=["celebrate"]
)
```

---

## ğŸ“Š éªŒè¯è¦ç‚¹

### æ¸¸æˆå†…æ£€æŸ¥ï¼š
1. âœ… `/reload` æ— é”™è¯¯
2. âœ… å®å¯æ¢¦èƒ½æ­£å¸¸ç”Ÿæˆ
3. âœ… æ‰“å¼€å®å¯æ¢¦èœå•ï¼ŒæŸ¥çœ‹æ‹›å¼åˆ—è¡¨
4. âœ… æ‹›å¼æŒ‰ç­‰çº§æ­£ç¡®æ˜¾ç¤º
5. âœ… è›‹æ‹›å¼ã€TMæ‹›å¼æ­£ç¡®æ˜¾ç¤º

---

## ğŸ“¦ äº¤ä»˜ç‰©

1. âœ… `tools/validators/move_validator.py` - æ‹›å¼éªŒè¯å™¨
2. âœ… `data/official_moves.json` - å®˜æ–¹æ‹›å¼å‚è€ƒæ•°æ®
3. âœ… `server.py` - æ›´æ–°æ‹›å¼ç³»ç»Ÿæ”¯æŒ
4. âœ… `generate_v1.6.0_tests.py` - æµ‹è¯•è„šæœ¬
5. âœ… `docs/design/V1.6.0_DESIGN.md` - æœ¬è®¾è®¡æ–‡æ¡£
6. âœ… `README.md` - æ›´æ–°æ–‡æ¡£
7. âœ… `CHANGELOG.md` - æ›´æ–°æ—¥å¿—

---

## ğŸ”„ å…¼å®¹æ€§

- âœ… **å‘åå…¼å®¹**ï¼šæ—§çš„ `moves=["1:tackle"]` ä»å¯ä½¿ç”¨
- âœ… **å‘å‰å…¼å®¹**ï¼šç”Ÿæˆçš„JSONæ ¼å¼ä¸å®˜æ–¹ä¸€è‡´
- âœ… **æ•°æ®è¿ç§»**ï¼šæ— éœ€è¿ç§»ï¼Œæ–°æ—§APIå¯æ··ç”¨

---

## âš ï¸ å·²çŸ¥é™åˆ¶

1. **ä¸æ”¯æŒè‡ªå®šä¹‰æ‹›å¼**ï¼šä»…æ”¯æŒå®˜æ–¹æ‹›å¼ï¼ˆéœ€è¦ Cobblemon Mega ç­‰æ¨¡ç»„ï¼‰
2. **ä¸æ”¯æŒæ‹›å¼æ•ˆæœ**ï¼šä»…é…ç½®æ‹›å¼åˆ—è¡¨ï¼Œæ•ˆæœç”±æ¨¡ç»„æ§åˆ¶
3. **ä¸æ”¯æŒè¿›åŒ–æ‹›å¼**ï¼š`learnableMoves` åœ¨è¿›åŒ–ç³»ç»Ÿä¸­é…ç½®

---

## ğŸ“ˆ å¼€å‘è¿›åº¦

- [x] éœ€æ±‚åˆ†æ
- [ ] åˆ›å»ºæ‹›å¼éªŒè¯å™¨
- [ ] å¯¼å…¥å®˜æ–¹æ‹›å¼æ•°æ®
- [ ] æ›´æ–° server.py
- [ ] åˆ›å»ºæµ‹è¯•è„šæœ¬
- [ ] æ¸¸æˆå†…éªŒè¯
- [ ] æ›´æ–°æ–‡æ¡£

